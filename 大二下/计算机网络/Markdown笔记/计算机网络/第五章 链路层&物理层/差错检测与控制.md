==**物理层以上各层都有改善数据传输质量责任，数据链路层差错控制最重要**==
意义在于将 **物理链路的不可靠** 变为 **无差错的数据链路**
	<font color="#ff0000">结果： "凡是接收端数据链路层接受的帧均无差错"</font>
## 差错原因
**物理层天然不可靠——噪声**
1. **==热噪声==**：随机差错，电子热运动导致，**幅度小，不能够消除**
2. ==**冲击噪声**==：突发差错，外界因素引起，**幅度大，主要差错原因**

## 差错度量
### 1. 信噪比 SNR
SNR = 信号功率 / 噪声功率 
![[SNR.png|500]]
- 信号功率越大，噪声越小，SNR越大

### 2.误码率 BER
Pe = 传错的比特数 / 传输的比特总数

## 差错考点1：检测和纠正
**==只要求掌握检错码==**，**纠错码（海明码）**
**检错码 Error Detection Code EDC**
**思想**：**==信息位==** 加上 **==冗余位（差错控制编码）==**

**总字长 = 信息位 + 冗余位**
	**编码效率=** 信息位/总字长

冗余位有三种设置方式：
1. 校验和
2. 奇偶校验
3. 循环冗余校验

==**怎么确认用的是哪个校验机制？ 发送方和接收方提前确定**==
### **校验和**
同TCP，UDP校验和计算方式，==**发送端**==：
- 将数据的每两个字节当作一个16位的整数，可分成若干整数
- 求和然后按位取反，**放在报文段首部，一起发送**
==**接收端：**==
相同的方法反码求和
- 等于“0”：收到的数据无差错
- 不等于“0”：收到的数据出现差错
### **奇偶校验**
奇校验和偶校验，都**只需要1个比特位**

e.g.假设信息位 为 `1010110`
- 奇校验：填0表示1的个数为奇数——**只能检测奇数个错误**
- 偶校验：填0表示1的个数为偶数
**明显，奇偶校验只根据奇/偶校验比较容易出错**

### **循环冗余校验——重点**
**本质**：模二除法

**==发送端检验流程：==**
1. **发送的比特串** `1010001`（信息位）
2. 发送方和接收方**共同选定一个生成多项式** `10111`  ==**K=4**==
   生成多项式最重要--确定余数的位数k位并对应最后的结果
3. 先补k个0 `1010001 0000`
4. ==**比特串 / 多项式 ,模二除法得到 余数**==
5. 余数替换末尾K位—— `1010001 1101`

10111 | 10100010000
		10111
		   11010
		   10111
		    11010
			10111
			 11010
			 10111
		      11010
		      10111
		       **1101**


==**接收端检验流程**==：
1. **收到的二进制串 / 生成多项式**  10100011101 / 10111
2. **得到0说明没问题**，得到非零说明校验错误

**注意：余数小于四位可能是忽略了前面的0 ，但不能往后面补0**

10111 | 10100011101
		10111
		   11011
		   10111
		    11001
		    10111
		     11100
		     10111
		      10111
		      10111
		      **00000**

### **练习1**
![[练习1.png|600]]
**注意多项式长度为最高幂+1：10111**
==**但是冗余位长度为最高幂次 K=4**==

**CRC校验码**= 1010010000+1010010000/10111=101001 **0010**

### **练习2**
例2：在数据传输过程中，若**接收方收到的二进制比特序列为10110011010**，收发双方采用的生成多项式为G(x)=x4+x3+1,则该二进制比特序列在传输中是否出错？如果没有错，那么发送数据的比特序列和CRC校验码比特序列分别是什么?

接受字符串：10110011010
多项式==**K=4**==: 11001
1011001**1010** / 11001 == 0 —— **正确!**

==**传输数据比特序列 -> 信息位 ： 1011001==**
**==CRC校验码比特序列 -> 冗余位： 1010**==
## 差错控制
检测到错误 → **丢弃该帧** + **发送方重传**


# 练习
**为了避免传输中帧的丢失**，数据链路层采用了（ ）方法
	**计时器超时重传**，检错码和纠错码不能避免丢失

