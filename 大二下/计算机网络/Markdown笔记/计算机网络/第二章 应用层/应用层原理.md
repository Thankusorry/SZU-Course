## 网络应用的体系架构
### **1.CS模式** **大部分**
**Client客户 + Server 服务器**
采用C/S模式**原因**：**==网络资源分布的不均匀性==**
**<font color="#ff0000">服务器是主</font>**:
- **不间断**地提供服务
- **永久性**访问地址
- 可拓展性的代价是**大量服务器(Date center)，性能随着用户增加到一定程度急剧下降**
**<font color="#4f81bd">客户端是从</font>**
- **主动**接受服务
- **间歇**接入网络
- 可以使用**动态IP**
- 不会与其他客户端**直接通信**
**优点：** 保证信息资源使用的合法性与安全性，以及保证数据的完整性与一致性
**缺点：** **可扩展性差，请求越多，反应越慢，一旦服务器宕机，服务中断——可靠性差**  
![[CS模式.png|409]]
#### **Web服务器、FTP、Telnet、电子邮件**
### **2.P2P模式 peer-peer** 
**<font color="#c0504d">每个应用进程既是客户端，又是服务端</font>**
#### **优点：**
1. **自拓展性**：请求和接受的节点都很多，不会剧烈变化
2. **带宽聚集**，速度更快
#### **缺点：**
**难以管理**
#### **例子：迅雷**
可以向其他客户端请求文件，也可以向其他用户提供文件片段

### **3.混合系统**
#### **Napster**
**文件搜索：集中** 
- 主机在中心服务器上**注册**其资源 
- 主机向中心服务器**查询**资源位置 
**文件传输：P2P** 
- 任意Peer节点之间
#### **即时通信  QQ**
**在线检测：集中**
- 用户上线，向中心服务器注册IP地址
- 用户向中心服务器联系，找到在线好友
**两个用户之间聊天：P2P**

## 进程通信
**应用层的通信实际上是进程间的通信**
<u>不同端系统上的进程</u>，通过计算机网络交换**报文message**
![[进程通信.png|675]]
**客户和服务器进程**
对于P2P也有客户端和服务器之分，因此Client Server更广泛的定义：
**发起通信的进程是客户，等待联系的进程是服务器**
### **需要解决的问题**
1.进程标识（区分唯一）和寻址问题 【**服务客户**】
2.传输层->应用层怎么提供服务(**原语和SAP**) **【服务】**
- 位置：层间界面的SAP（TCP/IP :socket）
- 形式：应用程序接口API（TCP/IP :socket API)
3.报文的格式和解释，以及采取的动作 **【用户使用服务】**
- 应用层协议：报文格式，解释，时序
- 编制程序，使用API，调用通信服务传输报文，实现应用时序
#### 1.问题一：**对进程进行编址 addressing**
你在哪个端系统上？
TCP还是UDP？
哪个应用进程接收？
**标识：**
1. **主机：唯一的32为IP地址**
2. **目标应用进程：端口号port number**
3. <u>端口号同时标识了TCP/UDP</u>
 - **HTTP: TCP 80**  **Mail: TCP25**  **ftp: TCP 2**
==因此，任何一对主机进程都可以通过IP+port标识==

#### 2.问题二：**层间服务**
**3个信息：发的什么？谁传的？传给谁？**
##### **层间接口必须要携带的信息**
1. **要传输的报文：SDU**
2. **发送方的IP+port**
3. **接收方的IP+port**
==**传输层实体（tcp或者udp实体）根据这些信息进行TCP报文段（UDP数据报）的封装**==
- 源端口号，目标端口号，数据等 
- <font color="#5f497a"><span style="background:#d3f8b6">将IP地址往下交IP实体，用于封装IP数据报</span></font>：源IP,目标IP

**<font color="#ff0000">Socket指定了应用所在的一个端节点（end point），进程通过socket发送和接受报文</font>**
应用层不需要关心Socket如何实现：**Socket就是一个门户**
![[Socket功能.png]]
##### **TCP SOCKET**
如果Socket API 每次传输报文，都携带如此多的信息，**太繁琐易错，不便于管理**
**socket：通过一个<font color="#ff0000">整数</font>来标识**
**<font color="#ff0000">TCP socket:</font>** **本地IP 本地端口 对方IP 对方端口** 的一个**整数**作为具有**本地意义**的标示
- **信息量最小：** 应用层和传输层之间约定一个整数，就不必在每一个报文的发送都要指定这4元组
	相当于一个**本机的快捷方式**，只有两层之间知道，其他人不会知道——需要一个速查表[Socket 建立]
- **简单，便于管理**
![[TCP socket.png|675]]
![[TCP socket detailed.png]]

##### **UDP SOCKET**
**UDP无连接**：在通信之前不需要握手
- 每个报文都是**独立传输**
- 前后报文**没有关联性**：可能给不同的目标进程
==**因此，只需标识我是谁——本地IP和端口**==
**UDP socket:本地唯一性仅由 本机 IP 地址 和 本机端口号 决定**
*但是,传输报文时必须提供**对方的IP，port***

**总共三个东西**：报文+UDP socket+对方IP,port

![[UDP socket.png|725]]
#### 3.问题三：**如果使用服务实现应用**
##### **应用层协议**
定义了应用进程如何相互交换报文
- **报文类型**：接受/应答报文
- **语法**：报文中各个字段及其描述
- **语义**：字段的含义
- **规则**：进程何时、如何发送报文及对报文进行响应
**协议只是网络应用的一个组成部分**，只是定义对等层如何交换报文
*Web应用还包括：IO流，Web客户端，HTML，Web浏览器、服务器...*

## 协议服务
描述协议能够为调用它的应用层序**提供什么样的服务？**
- **数据丢失率**
- **吞吐量**
- **延迟**
- **安全性**

**需要可靠：文件传输、电子邮件、Web文档**
**需要延迟低：视频会议，电话，流媒体，游戏**
### **Internet 传输层提供的服务**
[[传输层协议 TCP or UDP]]