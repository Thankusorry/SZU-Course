![[FTP.png|575]]
![[上传下载.png|575]]
# 基本概念
**FTP: File Transfer Protocol**
**作用**：**可靠地**向远程主机上**传输文件**或从远程主机**接收文件**
**C/S模式**
	客户端：**发起连接的一方**，服务器：**远程主机**
**FTP TCP端口号：<font color="#ff0000">21</font>** 
<font color="#ff0000">TCP（FTP协议）、UDP（TFTP协议）</font>
**客户既可以下载也可以上传**
**下载**：本地计算机用户（客户）将文件从FTP服务器传输到客户的过程
**上传**：客户端将文件从本地计算机传输到FTP服务器的过程
**FTP是命令响应交互式，<font color="#ff0000">有状态协议</font>**
- **服务器维护用户的状态信息**： 当前路径、用户帐户与控制连接对应
# FTP工作原理
两种连接：**控制连接和数据连接**
**==控制连接：端口号21**==
==**数据连接：端口号20==**
<font color="#ff0000">两个TCP连接</font>
![[FTP连接.png|441]]
![[端口号不同.png|775]]
>[!danger]+ 注意端口号
> CS模式里**只有服务器的端口号是固定的**，**客户端的端口号是临时分配的**
### **控制连接：最早开始，最后关闭**
1. **身份确认**
	1. **USER**：向服务器发送用户名
	2. **PASS**：向服务器发送用户口令 （密码）
2. **发送命令浏览远程目录**
	1. **LIST**：向服务器请求发送当前目录的文件列表
	2. **RETR（filename）**：从服务器端**检索**当前目录指定的文件 【GETS】
	3. **STOR（store filename）**：将客户主机的一个文件**存储**到FTP服务器中【PUTS】
**==FTP的响应命令==**
- **125：数据连接正确，准备传输文件**
- **150：数据连接即将打开**；**226：数据连接关闭**
- **220：服务就绪**；**221：服务关闭**
### **数据连接:另一个TCP连接**
- **收到文件传输指令，打开数据连接传输文件**
- **传输完成，关闭连接**
**==因此，每传输一次就要建立一次数据连接==**
![[FTP完整流程.png|725]]
## 匿名FTP
在FTP服务器上**建立一个公开账户（通常为Anonymous），并赋予该账户访问公共目录的权限，以便提供免费的服务**
要访问匿名服务FTP，不需要输入用户名与用户密码（也可以用“Anonymous”作为用户名，用“Guest”作为密码
**==匿名FTP服务只允许用户下载文件，不允许用户上传文件==**

## ！！！考点：FTP和TFTP区别
**==TFTP是简洁版的FTP==**
- **传输可靠性**：F**TP面向连接的可靠传输，采用TCP**；**TFTP简洁、采用UDP**
- **协议命令集**：FTP包含发送/接收文件、列出目录与删除文件等复杂命令，**TFTP协议只定义文件发送/接收基本命令**
- **数据表示**：<span style="background:#d3f8b6">FTP可指定数据类型</span>，**TFTP只允许传输ASCII码或二进制文本文件**
- **用户鉴别**：FTP有登录用户鉴别功能，**TFTP不提供用户鉴别功能**

# 练习
1. FTP客户和服务器间传递FTP命令时，使用的连接是（     ）。
**A. 建立在TCP之上的控制连接**					
B. 建立在TCP之上的数据连接
C. 建立在UDP之上的控制连接					
D. 建立在UDP之上的数据连接
2. 下列关于FTP的叙述中，错误的是（         ）。
A.  数据连接在每次数据传输完毕后就关闭		
==B.  控制连接在整个会话期间保持打开状态==
C.  服务器与**客户端的TCP20端口**建立数据连接		
D.  客户端与服务器的TCP21端口建立控制连接
3. 下列关于FTP连接的叙述中，正确的是（       ）。
A.控制连接先于数据连接被建立，并先于数据连接被释放	
B.数据连接先于控制连接被建立，并先于控制连接被释放
**C.控制连接先于数据连接被建立，并晚于数据连接被释放**
D.数据连接先于控制连接被建立，并晚于控制连接被释放
4. 匿名FTP访问通常使用（       ）作为用户名。
A. Guest		B. Email地址		**C. Anonymous**		D. 主机ID
5. 一个FTP用户发送了一个LIST命令来获取服务器的文件列表，这时服务器应该通过（ ）端口来**传输**该列表。
  A.21			**B. 20**			C. 22			D. 19
6. 下列关于FTP的叙述中，错误的是（    ）。
A. FTP可以在不同类型的操作系统之间传送文件	 	
==B. FTP并不适合用在两个计算机之间共享读写文件==
C. 控制连接在整个FTP会话期间一直保持		               
D. **客户端默认使用端口20**与服务器建立数据传输连接
7. 以下关于FTP用户程序特点的描述中，错误的是（        ）。
A.FTP用户程序主要有传统的FTP命令行、浏览器与FTP下载工具
B.传统的FTP命令行是最早的FTP用户程序
C.**浏览器软件支持访问FTP服务器，可以直接登录到FTP服务器并下载文件**
D.使用FTP命令行从FTP服务器下载文件的过程中网络连接意外中断，用户程序==通过断点续传功能可以继续进行剩余部分的传输==

***浏览器不能直接登录FTP服务器，需要通过FTP方式***