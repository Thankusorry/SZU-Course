![[电子邮件服务.png|500]]
![[收发过程.png|675]]
## 1.基本组成
0. **电子邮箱：** 由提供电子邮件服务的机构（ISP）为用户建立
	- 用户名@主机名 e.g. csse@szu.edu.cn
1. **User agent 用户代理** ：阅读，回复，转发，保存，撰写报文
	- Outlook,Apple mail , 对于Web邮件服务，用户代理是Web浏览器
2. **mail Server 邮件服务器**
	1. **外出报文队列 massage queue**:保持**待发送**邮件报文
	2. **用户邮箱 mail box** : 管理和维护**尚未阅读的接收的报文** 
3. **Simple Mail Transfer Protocol (SMTP) 简单邮件传输协议**
4. **邮件<font color="#ff0000">存储访问</font>协议：POP3、IMAP4**
**Important: SMTP命令/响应交互式：==邮件报文必须使用7-bit ASCII表示==**
——7位ASCII仅有128个编码，仅处理可打印字符和控制字符，无法编码其他**二进制数据（8位字节流）**
### **常见SMTP命令和应答**
**S:220 服务就绪** 
**C:HELO 发送端的主机名**
**S:250 请求命令完成**
**QUIT**
## 2.SMTP协议
基于TCP协议 C/S模式 ——<font color="#ff0000">端口号为25，持续连接</font>
**流程：握手——传输——关闭**
**==SMTP是一种推(push)协议：客户端（主动发起连接）：发送方邮件服务器==**--服务器：接收端邮件服务器
**Important: SMTP命令/响应交互式：==邮件报文必须使用7-bit ASCII表示==**
——**7位ASCII仅有128个编码，仅处理可打印字符和控制字符，无法编码其他二进制数据（8位字节流）**
### **报文格式**
**首部行**：To、From、Date、Subject: 与SMTP命令不同！
**主体**  **：报文，只能是ASCII码字符**
![[SMTP报文格式.png|450]]
## 3.多媒体邮件拓展——MIME
Multimedia mail extension **允许非7位ASCII码数据通过SMTP传输**
**==本质就是一种编码方式（Base64算法），将非ASCII转为7位ASCII码==**
>[!fail]+ 易错
> **MIME不是一种邮件传输协议**

![[MIME工作模式.png|475]]
在报文首部用**额外的行申明MIME内容类型**
![[MIME-1.png|650]]
## 4.邮件存储访问协议 POP3,IMAP4,HTTP
**访问：从服务器访问邮件**
### **POP3(Post Office Protocol) 邮局访问协议**
1. **用户确认阶段：**
	1. 客户端输入user,pass 用户名和密码
	2. 服务器响应 OK/ERR
2. **事务处理阶段：客户端给出指令，服务器处理**
	1. list：报文号列表
	2. retr：根据报文号检索报文
	3. dele:删除
	4. quit:退出
POP3是 **“下载并删除/保留”** 模式
***保留***  **:可以在不同客户端都看到邮件**
### **IMAP4(Internet Mail Access Protocol) 互联网邮件访问协议**
**与POP3类似，但功能更强**
#### **区别**
1. **POP3在会话中是无状态的,IMAP则保留用户状态**
2. **POP3是本地管理文件夹，IMAP4远程管理文件夹，提供更多功能**
>[!example]+ IMAP4功能
>下载邮件之前**检查邮件头部**
下载邮件之前可用特定字符串**搜索**电子邮件的内容
可以**下载部分**电子邮件
可以在邮件服务器上**创建、删除、更名**邮箱

### **HTTP(HyperText Transfer Protocol)**
**基于Web的电子邮件**
**==用户代理就是Web浏览器==**
**==用户与远程邮箱之间的通信使用的是HTTP协议，而不是发送SMTP，接受POP3或IMAP4协议==**
**邮件服务器之间的通信仍然使用SMTP协议**
# 练习

1. 浏览器与Web服务器之间使用的协议是（       ）。
A. DNS                B. SNMP                **C. HTTP**             D. SMTP
2. 以下应用层协议中，不采用C/S工作模式的是（）。
A、DNS		       **B. BitTorrent**                 C、FTP                 D、SMTP
3. 下列关于HTTP的描述，正确的是（      ）。
A. 用户请求一个网页，该网页包含了文本内容和三个图片，客户端将发送一个请求报文并收到4个响应报文。
**B. 两个网页有可能通过一个持续连接发送。**
C. 在使用非持续连接时，一个TCP报文段可能携带两个不同的HTTP请求报文。
D. HTTP不能使用并行的TCP连接。 
4. 超文本传输协议用的端口号是（    ）。
A、53               **B、80**               C、21               D、23
5. 检查局域网连通性常用的网络命令是（      ）。
A．DNS              B．IPCONFIG           C．BIND             **D．PING**
6. 在**因特网电子邮件系统**中，电子邮件应用程序（     ）。
A、发送邮件和接收邮件都采用SMTP协议
B、**发送邮件通常使用SMTP协议，接收邮件用POP3协议**
C、发送邮件通常使用POP3协议，接收邮件用SMTP协议
D、发送邮件和接收邮件都用POP3协议
7. 电子邮件的地址有两部分组成，即用户名@（    ）。
A．文件名            **B．域名**                   C．匿名       D．设备名
8. 考虑Alice和Bob均采用**Web邮箱**收发邮件，那么在Alice向Bob发邮件的过程中，Alice的邮件从其主机到邮件服务器传输采用（  ）协议；Alice的邮件服务器利用（ ）协议将邮件发送给Bob的邮件服务器，Bob主机利用（ ）协议从他的邮件服务器上读取邮件。
A. SMTP；SMTP；POP3或IMAP4                B. POP3或IMAP4；SMTP；SMTP
C. HTTP；SMTP；POP3或IMAP4                 **D. HTTP；SMTP；HTTP**

