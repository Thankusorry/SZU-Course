![[Pasted image 20250308215428.png|400]]
![[网络分类.png]]
# 基本问题

数据怎么通过网络进行传输的？
## 电路交换 Circuit Switch
“需要预定的餐馆”
为每个呼叫预留一条 **专有电路**：如电话网

端到端的资源被分配给从源端到目标端的呼叫“call”

![[Pasted image 20250308215638.png|425]]
链路通过各种方法（频分，时分，波分）**被分成piece**，各个piece独享资源——**<font color="#ff0000">能够保证性能</font>**，不同路由器间的piece连接构成一个**独享的线路**
因此如果不传输数据，被分配的 **<font color="#c0504d">资源会被浪费(no sharing)</font>**
### **特点：**
- 预留端到端资源，链路带宽、交换能力
- 专用资源：不共享
- 保证性能
- **<font color="#c0504d">要求建立呼叫连接</font>**
### **应用：**
传统电话网络
![[Pasted image 20250308220644.png|425]]
### **怎么分配 Piece？**
**为呼叫分配Piece** 
如果某个呼叫没有数据， 则其资源片处于空闲状态 （不共享）
#### **1.FDM Frequency-Division Multiplexing 频分复用**
![[Pasted image 20250308221432.png|750]]
特定的频段，e.g.调频无线电台，每个电台被分配一个特定的频段FMxxxx
#### **2.TDM Time-Division Multiplexing 时分复用**
![[Pasted image 20250308221445.png|700]]
时间被分为固定期间的 **帧** ，每个帧又被花费为固定数量的 **时隙** ，每个用户分配相同的专用时隙  
传输速率=帧速率 * 一个时隙中的比特数量 
	if 链路每秒传输8k个帧，每个时隙由8byte组成，则一个电路传输速率为 64k bps
##### 小练习
从主机A到主机B通过电路交换发送一个640k byte的文件需要多长时间? 
	假设所有链路具有24时隙的TDM，byte速率为1.536Mbps，A发送前需要0.5s创建一条端到端电路
>[!quote]+ Answer
> 24时隙：每条电路传输速率为1.536Mbps/24=64kbps
> 传输文件时间=640k/64kbps=10s                                                                          
> 所以需要10+0.5=10.5s + 传播时延

#### **3.Wave-Division Multiplexing 波分复用**
常用于光传输中

### **不适合计算机之间的通信**
- 连接建立时间太长（秒级别）
- 计算机之间的通信有**突发性** ，**线路交换浪费的片较多**
- 资源浪费较高
- **可靠性不高<font color="#ff0000">？</font>** 维护piece and piece 之间的通信，核心节点损坏，影响较大

## 分组交换 Packet Switch
![[分组交换.png]]
### **特点：**
1. 网络带宽使用全部带宽，**要用全用**
2. 以==**分组**==为单位==**存储-转发方式**==
3. **资源<font color="#d83931">共享</font>，按需使用：<font color="#4bacc6">耗费了存储时间和排队时间</font>**
### **存储-转发**
<span style="background:rgba(240, 107, 5, 0.2)">Q:为什么要存储-转发，而不是收到每个byte直接转走？</span>
	A:**哎，那不就是电路交换吗？而且<font color="#ff0000">独享</font>了带宽的全部，比电路还夸张**
分组每次移动一跳 **（hop）**

**<font color="#c00000">延时计算：</font>** 在一个**速率为R bps的链路** ，一个**长度为L bits 的分组** 的**存储转发延时**：**L/R s** 

<span style="background:rgba(240, 107, 5, 0.2)">Q:发送5s，接受5s,为什么不是10s呢？</span>
	**A发送的同时B接受，是同时发生的**（忽略传播延时）

#### **两种方式**
##### **1.数据报网络Datagram 无连接** 
- 分组的目标地址决定下一跳
- 不同阶段，路由可以改变
- **类似：问路**
- Internet
**工作原理：**
1. 在通信之前,**无须建立起一个连接**,**有数据就传输**
2. 每一个分组都**独立路由** <font color="#d83931">(路径不一样,到达时间不一样，可能会失序)</font>
3. 路由器根**据分组的目标地址进行路由**
![[Datagram.png]]

##### **2.虚电路（Virtual circuit）有连接**
- 每个分组都带**标签 <font color="#d83931">信令</font> 协议**（虚电路标识VC ID），标签**决定下一跳**
- **在呼叫建立时决定路径**，在整个呼叫中**路径保持不变**
- 路由器**维持**每个呼叫的**状态**信息
- ***X.25 和 ATM***
**工作原理：**
![[虚电路.png|750]]
#### **缺点：排队和延迟**
**如果分组到达的速率>链路的输出速率**
- 分组就会**排队**，等待传输 （此时分组存放在路由器的**输出缓存**中）
- 如果路由器缓存满了，分组就会被丢弃——**丢包 packet loss**
![[排队和延迟.png]]
### **核心功能**
#### **1.路由**
决定分组采用的源到目标的路径 **forwarding table转发表** 
	路由算法：dest address in arriving packet’s **header**
![[routing algorithm.png|254]]
#### **2.转发**
将分组从路由器的输入链路转移到输出链路

### **统计多路复用**
A&B **时分复用**链路资源，但分组没有固定的模式，A/B/空闲--->**统计多路复用**
**Static Time-Division Multiplexing**


## 电路交换vs分组交换
毫无疑问，**同样的网络资源，分组交换允许更多用户使用网络！**

### **例子解释：**
#### **条件：**
1. **链路总速率为1Mbps**
2. 每个用户**传输数据占用带宽 100kbps**
3. **仅有10%时间活跃**

**电路交换：最多支持 10（=1Mbps/100kbps)个并发的用户**

**分组交换：** 假设有35个用户，有11或更多**并发活跃用户**的概率是0.0004(伯努利分布)
$1-\sum_{n=0}^9\binom{35}np^n\left(1-p\right)^{35-n}$
==*为什么是9，而不是10，后面会介绍的**流量强度***==

**分组交换99.6%的情况下可以hold得住35个用户的资源共享**
——更适合**突发式数据传输**
	资源共享
	简单，不需要建立呼叫
**过度使用会造成网络拥塞：分组延时和丢失**
——对可靠地数据传输需要协议来约束：**拥塞控制**

